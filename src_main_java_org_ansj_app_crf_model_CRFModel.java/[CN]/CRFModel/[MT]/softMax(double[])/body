{
  double max=Double.MIN_VALUE;
  for (  double a : A) {
    if (a > max) {
      a=max;
    }
  }
  double sum=0;
  for (  double a : A) {
    sum+=Math.exp(a - max);
  }
  return Math.log(sum) + max;
}
